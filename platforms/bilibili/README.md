# Bilibili å¹³å° API æ–‡æ¡£

## ç®€ä»‹

Bilibili å¹³å°é€‚é…å™¨æä¾›äº†å¯¹ Bilibili API çš„ç»Ÿä¸€å°è£…ï¼Œæ”¯æŒè§†é¢‘ã€éŸ³é¢‘ã€ç”¨æˆ·ç­‰ç›¸å…³åŠŸèƒ½ã€‚

## å¹³å°ç‰¹æ€§

- **å¹³å°åç§°**: `bilibili`
- **é»˜è®¤ç¼“å­˜**: 10åˆ†é’Ÿ
- **è¯·æ±‚è¶…æ—¶**: 10ç§’
- **æ”¯æŒåŠŸèƒ½**: è§†é¢‘ä¿¡æ¯ã€æœç´¢ã€ç”¨æˆ·ä¿¡æ¯ç­‰

## é…ç½®è¯´æ˜

### æ ¸å¿ƒé…ç½®

```javascript
{
  apiDomain: "https://api.bilibili.com",
  domain: "https://www.bilibili.com",
  timeout: 10000,
  retryCount: 3
}
```

### ç¼“å­˜é…ç½®

é»˜è®¤ç¼“å­˜æ—¶é—´ä¸º 10 åˆ†é’Ÿï¼Œå¯åœ¨ `config.js` ä¸­çš„ `ROUTE_CACHE_CONFIGS` ä¸ºä¸åŒè·¯ç”±è®¾ç½®ç‹¬ç«‹çš„ç¼“å­˜ç­–ç•¥ã€‚

## API æ¨¡å—

æ¨¡å—æ–‡ä»¶ä½äº `module/` ç›®å½•ä¸‹ï¼Œæ¯ä¸ª `.js` æ–‡ä»¶å¯¹åº”ä¸€ä¸ª API æ¥å£ã€‚

### å·²å®ç°æ¥å£

- âœ… **æœç´¢å»ºè®®** (`/search/suggest`) - è·å–æœç´¢å…³é”®è¯å»ºè®®
- âœ… **ç»¼åˆæœç´¢** (`/search`) - æœç´¢è§†é¢‘ã€ç”¨æˆ·ç­‰å†…å®¹ï¼ˆå“åº”æ ¼å¼ä¸ Netease ä¿æŒä¸€è‡´ï¼‰
- âœ… **æ’­æ”¾åœ°å€** (`/video/playurl`) - è·å–è§†é¢‘/éŸ³é¢‘æ’­æ”¾æµåœ°å€

### è·¨å¹³å°å…¼å®¹æ€§

Bilibili æœç´¢æ¥å£æ”¯æŒ Netease å¹³å°çš„å‚æ•°æ ¼å¼ï¼Œæ–¹ä¾¿è·¨å¹³å°åˆ‡æ¢ï¼š
- æ”¯æŒ `keywords` å‚æ•°ï¼ˆå…¼å®¹ `keyword`ï¼‰
- æ”¯æŒ `type` å‚æ•°ï¼ˆå…¼å®¹ `search_type`ï¼‰
- æ”¯æŒ `limit/offset` å‚æ•°ï¼ˆå…¼å®¹åˆ†é¡µï¼‰
- å“åº”æ ¼å¼ç»Ÿä¸€ä¸º `{ result: { videos: [], videoCount, hasMore } }`

### æ¨¡å—å¼€å‘è§„èŒƒ

æ¯ä¸ªæ¨¡å—åº”å¯¼å‡ºä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š

```javascript
/**
 * æ¨¡å—ç¤ºä¾‹
 * @param {Object} query - æŸ¥è¯¢å‚æ•°
 * @param {Function} request - è¯·æ±‚å‡½æ•°
 * @returns {Promise} è¿”å›ç»“æœ
 */
module.exports = async (query, request) => {
  // å‚æ•°å¤„ç†
  const { id } = query
  
  // è°ƒç”¨ API
  const result = await request('/x/web-interface/view', {
    aid: id
  })
  
  // è¿”å›æ•°æ®
  return result.data
}
```

### æ¨¡å—æ–‡ä»¶å‘½å

- ä½¿ç”¨ä¸‹åˆ’çº¿ `_` åˆ†éš”å¤šçº§è·¯ç”±
- ä¾‹å¦‚: `search_suggest.js` å¯¹åº”è·¯ç”± `/search/suggest`
- ä¾‹å¦‚: `user_video_list.js` å¯¹åº”è·¯ç”± `/user/video/list`

## ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€è¯·æ±‚

```bash
# æœç´¢å»ºè®®ï¼ˆè‡ªåŠ¨è¡¥å…¨ï¼‰
GET /search/suggest?keyword=éŸ³ä¹&platform=bilibili

# æœç´¢è§†é¢‘ï¼ˆé»˜è®¤è¿”å›20æ¡ï¼‰
GET /search?keyword=éŸ³ä¹&platform=bilibili

# æœç´¢è§†é¢‘ï¼ˆæŒ‡å®šè¿”å›æ•°é‡ï¼‰
GET /search?keyword=éŸ³ä¹&page_size=10&platform=bilibili

# æœç´¢ç”¨æˆ·
GET /search?keyword=éŸ³ä¹&search_type=bili_user&platform=bilibili

# è·å–æ’­æ”¾åœ°å€ï¼ˆéŸ³é¢‘æµï¼‰
GET /video/playurl?bvid=BV1xx411c7mD&cid=123456&platform=bilibili
```

### å¸¦è®¤è¯çš„è¯·æ±‚

æŸäº›æ¥å£éœ€è¦ç”¨æˆ·è®¤è¯ï¼Œå¯ä»¥é€šè¿‡ cookie å‚æ•°ä¼ é€’ï¼š

```bash
# è·å–æ’­æ”¾åœ°å€ï¼ˆæŸäº›è§†é¢‘å¯èƒ½éœ€è¦è®¤è¯ï¼‰
GET /video/playurl?bvid=BV1xx411c7mD&cid=123456&cookie=SESSDATA=xxx&platform=bilibili
```

## åˆ†åŒºé…ç½®

Bilibili è§†é¢‘åˆ†åŒº ID æ˜ å°„ï¼š

- `music` (3): éŸ³ä¹åŒº
- `dance` (129): èˆè¹ˆåŒº
- `game` (4): æ¸¸æˆåŒº
- `knowledge` (36): çŸ¥è¯†åŒº
- æ›´å¤šåˆ†åŒºè¯¦è§ `config.js`

## æ³¨æ„äº‹é¡¹

1. **é¢‘ç‡é™åˆ¶**: Bilibili API æœ‰é¢‘ç‡é™åˆ¶ï¼Œå»ºè®®åˆç†ä½¿ç”¨ç¼“å­˜
2. **Cookie æœ‰æ•ˆæœŸ**: è®¤è¯ Cookie (SESSDATA) æœ‰æ—¶æ•ˆæ€§ï¼Œéœ€å®šæœŸæ›´æ–°
3. **åŒºåŸŸé™åˆ¶**: éƒ¨åˆ†å†…å®¹å¯èƒ½æœ‰åœ°åŒºé™åˆ¶
4. **æ¥å£å˜åŠ¨**: Bilibili API å¯èƒ½ä¼šè°ƒæ•´ï¼Œéœ€è¦å…³æ³¨æ¥å£æ›´æ–°

## å¼€å‘è®¡åˆ’

- [x] æœç´¢å»ºè®®ï¼ˆè‡ªåŠ¨è¡¥å…¨ï¼‰âœ…
- [x] ç»¼åˆæœç´¢ âœ…
- [x] æ’­æ”¾åœ°å€è·å– âœ…
- [ ] è§†é¢‘ä¿¡æ¯æŸ¥è¯¢ ğŸš§
- [ ] ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ ğŸš§
- [ ] è¯„è®ºè·å– ğŸš§
- [ ] å¼¹å¹•è·å– ğŸš§
- [ ] è§†é¢‘æ¨è ğŸš§
- [ ] çƒ­é—¨è§†é¢‘ ğŸš§
- [ ] ç”¨æˆ·æŠ•ç¨¿åˆ—è¡¨ ğŸš§
- [ ] ç”¨æˆ·åŠ¨æ€ ğŸš§
- [ ] æ”¶è—å¤¹ç®¡ç† ğŸš§

## å‚è€ƒèµ„æº

- [Bilibili API æ–‡æ¡£](https://github.com/SocialSisterYi/bilibili-API-collect)
- [Bilibili å¼€æ”¾å¹³å°](https://openhome.bilibili.com/)

## è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ªä¸»é¡¹ç›®çš„è®¸å¯è¯ã€‚

